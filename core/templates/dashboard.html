<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{% static 'dashboard_style.css' %}">
</head>
<body>
    <div class="app-container">
        <!-- Mobile Menu Toggle -->
        <button class="mobile-menu-toggle d-md-none" id="mobileMenuBtn">
            <i class="fas fa-bars"></i>
        </button>

        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="brand">
                    <div>
                        <h5 class="brand-title">ðŸ“§ Vectra</h5>
                    </div>
                </div>
            </div>

            <div class="search-box">
                <input type="search" placeholder="Search..." class="form-control">
            </div>

            <nav class="sidebar-nav">
                <button class="nav-item active" data-nav="tab-home">
                    <i class="fas fa-home"></i>
                    <span>Home</span>
                </button>

                <button class="nav-item" data-nav="tab-scheduled">
                    <i class="fa-regular fa-calendar"></i>
                    <span>Scheduled</span>
                </button>

                <button class="nav-item" data-nav="tab-groups">
                    <i class="fa-solid fa-user-group"></i>
                    <span>Groups</span>
                </button>

                <button class="nav-item" data-nav="tab-history">
                    <i class="fa-regular fa-clock"></i>
                    <span>History</span>
                </button>

                <button class="nav-item" data-nav="tab-guides">
                    <i class="fa-solid fa-book-open"></i>
                    <span>Guides</span>
                </button>

                <button class="nav-item" data-nav="tab-community">
                    <i class="fa-regular fa-comments"></i>
                    <span>Community</span>
                </button>
            </nav>

            <div class="sidebar-footer">
                <button class="sidebar-footer-item" id="profileTrigger" type="button">
                    <div class="user-avatar">{{ avatar }}</div>
                    <div>
                        <span>{{ full_name }}</span>
                        <span class="badge badge-secondary">Free</span>
                    </div>
                </button>
            
                <!-- Profile Popup -->
                <div class="profile-popup" id="profilePopup">
                    <div class="popup-actions">
                        <button class="btn btn-sm btn-sec btn-secondary w-100 mb-2">Upgrade Plan</button>
                        <button class="btn btn-sm btn-sec btn-secondary w-100 mb-2">Account Settings</button>
                        <button class="btn btn-sm btn-sec btn-secondary w-100 mb-2">Help</button>
                        <form action="/logout/" method="POST" class="w-100">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-sm btn-danger w-100"> Logout</button>
                        </form>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Overlay for mobile menu -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>

        <!-- Main Content -->
        <div class="main-container">
            <!-- Header -->
            <header class="header">
                <button class="sidebar-toggle d-none d-md-inline-flex" id="sidebarToggle">
                    <i class="fas fa-panel-left"></i>
                </button>
                <h1 class="header-title"></h1>
                <div class="header-actions">
                    <button class="header-btn" title="Cloud Storage">
                        <i class="fas fa-cloud"></i>
                    </button>
                    <button class="header-btn" title="Messages">
                        <i class="fas fa-message"></i>
                    </button>
                    <button class="header-btn notification-btn" title="Notifications">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge">5</span>
                    </button>
                </div>
            </header>

            <!-- Content Area -->
            <main class="content-area">
                <!-- Home Section -->
                <div class="tab-content active" id="tab-home"> Home </div>
                <!-- Scheduled Section -->
                <div class="tab-content" id="tab-scheduled">
                    <div class="row g-4 mb-5">
                        <div class="col">
                            <section class="content-section">
                                <div class="threads-section-header">
                                    <h2 class="section-title">Scheduled</h2>
                                    <div>
                                        <button class="threads-icons">
                                            <i class="fa-solid fa-magnifying-glass"></i>
                                            Search
                                        </button>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>
                </div>
                <!-- Groups Section -->
                <div class="tab-content" id="tab-groups">
                    <div class="row g-4 mb-5">
                        <div class="col-lg-9">
                            <section class="content-section">
                                <div class="groups-section-header">
                                    <h2 class="section-title">Groups</h2>
                                    <div>
                                        <button class="btn btn-sec btn-secondary">
                                            <i class="fa-solid fa-magnifying-glass me-2"></i>
                                            Search
                                        </button>
                                        <button id="createNewBtn" class="btn btn-pri btn-primary">
                                            <i class="fa-solid fa-pencil me-2"></i>
                                            Create New 
                                        </button>
                                    </div>
                                </div>
                                <div class="groups-list">
                                    {% for group in groups %}
                                    <div class="groups-item">
                                        <div class="groups-header">
                                            <h4 class="groups-name">{{ group.name }}</h4>
                                        
                                            <div class="actions">
                                                <span class="recipient-count">
                                                    <i class="fa-solid fa-user"></i>
                                                    {{ group.emails.count }}
                                                </span>
                                            
                                                <button class="dropdown-btn me-2" onclick="toggleRecipients('{{ group.id }}')">
                                                    <i class="fa-solid fa-angle-down"></i>
                                                </button>
                                            </div>
                                        </div>
                                    
                                        <div class="groups-footer">
                                            <p class="description">{{ group.description }}</p>
                                            <div class="ms-auto">
                                                <button class="btn btn-sec btn-secondary">
                                                    <i class="fa-solid fa-pencil me-2"></i>
                                                    Compose
                                                </button>
                                            </div>
                                        </div>

                                        <!-- Hidden by default -->
                                        <div id="recipients-{{ group.id }}" class="groups-recipients hidden">
                                            <!-- Email Addresses -->
                                            <strong>Recipients:</strong>
                                            <div class="recipient-list">
                                                {% for email in group.emails.all %}
                                                    <span class="recipient">{{ email.email }}</span>
                                                {% endfor %}
                                            </div>
                                            <!-- Delete Group -->
                                            <form method="POST" action="{% url 'core:delete_group' group.id %}">
                                                {% csrf_token %}
                                                <button type="submit" class="btn btn-sm btn-danger">Delete Group</button>
                                            </form>
                                        </div>
                                    </div>
                                    {% endfor %}
                            </section>
                        </div>
                    </div>
                </div>
                <!-- History Section -->
                <div class="tab-content" id="tab-history">
                    <div class="row g-4 mb-5">
                        <div class="col">
                            <section class="content-section">
                                <div class="threads-section-header">
                                    <h2 class="section-title">History</h2>
                                    <div>
                                        <button class="threads-icons">
                                            <i class="fa-solid fa-magnifying-glass"></i>
                                            Search
                                        </button>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>
                </div>
                
                <!-- Guides Section (Static) -->
                <div class="tab-content" id="tab-guides">
                    <!-- Hero Banner -->
                    <section class="hero-banner mb-5">
                        <div class="hero-content">
                            <span class="badge badge-light mb-3">Premium</span>
                            <h2 class="hero-title">Vectra Support</h2>
                            <p class="hero-description">Experience dedicated 24/7 premium assistance on Vectra, delivering reliable, fast, and expert support to ensure seamless performance and user satisfaction.</p>
                            <div class="hero-actions">
                                <button class="btn btn-light rounded-pill">Upgrade Plan</button>
                                <button class="btn btn-outline-light rounded-pill" id="notIntrested">Not Intrested</button>
                            </div>
                        </div>
                        <div class="hero-visual d-none d-lg-block">
                            <div class="rotating-circles">
                                <div class="circle circle-1"></div>
                                <div class="circle circle-2"></div>
                                <div class="circle circle-3"></div>
                                <div class="circle circle-4"></div>
                            </div>
                        </div>
                    </section>
                    <!-- First Party Guides (Static) -->
                    <section>
                        <div class="section-header">
                            <h3 class="section-title">Guides from Vectra</h3>
                        </div>
                        <div class="cards-grid">
                            <div class="community-card">
                                <div class="card-image">
                                    <img src="https://images.pexels.com/photos/196650/pexels-photo-196650.jpeg" alt="Writing with Vectra">
                                </div>
                                <div class="card-content">
                                    <h4 class="card-title">Writing Emails with Vectra</h4>
                                    <p class="card-meta">by Alex Morgan</p>
                                    <div class="card-stats">
                                        <span><i class="fas fa-heart text-danger me-1"></i>342</span>
                                        <span><i class="fas fa-comment text-info me-1"></i>28</span>
                                        <span class="ms-auto text-muted">2 days ago</span>
                                    </div>
                                </div>
                            </div>

                            <div class="community-card">
                                <div class="card-image">
                                    <img src="https://images.pexels.com/photos/5473955/pexels-photo-5473955.jpeg" alt="Exploring Vectra AI">
                                </div>
                                <div class="card-content">
                                    <h4 class="card-title">Exploring Vectra AI</h4>
                                    <p class="card-meta">by Priya Sharma</p>
                                    <div class="card-stats">
                                        <span><i class="fas fa-heart text-danger me-1"></i>518</span>
                                        <span><i class="fas fa-comment text-info me-1"></i>47</span>
                                        <span class="ms-auto text-muted">1 week ago</span>
                                    </div>
                                </div>
                            </div>

                            <div class="community-card">
                                <div class="card-image">
                                    <img src="https://images.pexels.com/photos/9062772/pexels-photo-9062772.jpeg" alt="Scheduling Mails">
                                </div>
                                <div class="card-content">
                                    <h4 class="card-title">Scheduling Mails for Better Sleep</h4>
                                    <p class="card-meta">by Thomas Wright</p>
                                    <div class="card-stats">
                                        <span><i class="fas fa-heart text-danger me-1"></i>276</span>
                                        <span><i class="fas fa-comment text-info me-1"></i>32</span>
                                        <span class="ms-auto text-muted">3 days ago</span>
                                    </div>
                                </div>
                            </div>

                            <div class="community-card">
                                <div class="card-image">
                                    <img src="https://images.pexels.com/photos/3184418/pexels-photo-3184418.jpeg" alt="Vectral Spaces">
                                </div>
                                <div class="card-content">
                                    <h4 class="card-title">Vectral Spaces 101</h4>
                                    <p class="card-meta">by Olivia Chen</p>
                                    <div class="card-stats">
                                        <span><i class="fas fa-heart text-danger me-1"></i>189</span>
                                        <span><i class="fas fa-comment text-info me-1"></i>15</span>
                                        <span class="ms-auto text-muted">5 days ago</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <br><br>
                    <!-- Third Party Guides (Static) -->
                    <section>
                        <div class="section-header">
                            <h3 class="section-title">Community Guides</h3>
                        </div>
                        <div class="cards-grid">
                            <div class="community-card">
                                <div class="card-image">
                                    <img src="https://images.pexels.com/photos/196650/pexels-photo-196650.jpeg" alt="Writing with Vectra">
                                </div>
                                <div class="card-content">
                                    <h4 class="card-title">Writing Emails with Vectra</h4>
                                    <p class="card-meta">by Alex Morgan</p>
                                    <div class="card-stats">
                                        <span><i class="fas fa-heart text-danger me-1"></i>342</span>
                                        <span><i class="fas fa-comment text-info me-1"></i>28</span>
                                        <span class="ms-auto text-muted">2 days ago</span>
                                    </div>
                                </div>
                            </div>

                            <div class="community-card">
                                <div class="card-image">
                                    <img src="https://images.pexels.com/photos/5473955/pexels-photo-5473955.jpeg" alt="Exploring Vectra AI">
                                </div>
                                <div class="card-content">
                                    <h4 class="card-title">Exploring Vectra AI</h4>
                                    <p class="card-meta">by Priya Sharma</p>
                                    <div class="card-stats">
                                        <span><i class="fas fa-heart text-danger me-1"></i>518</span>
                                        <span><i class="fas fa-comment text-info me-1"></i>47</span>
                                        <span class="ms-auto text-muted">1 week ago</span>
                                    </div>
                                </div>
                            </div>

                            <div class="community-card">
                                <div class="card-image">
                                    <img src="https://images.pexels.com/photos/9062772/pexels-photo-9062772.jpeg" alt="Scheduling Mails">
                                </div>
                                <div class="card-content">
                                    <h4 class="card-title">Scheduling Mails for Better Sleep</h4>
                                    <p class="card-meta">by Thomas Wright</p>
                                    <div class="card-stats">
                                        <span><i class="fas fa-heart text-danger me-1"></i>276</span>
                                        <span><i class="fas fa-comment text-info me-1"></i>32</span>
                                        <span class="ms-auto text-muted">3 days ago</span>
                                    </div>
                                </div>
                            </div>

                            <div class="community-card">
                                <div class="card-image">
                                    <img src="https://images.pexels.com/photos/3184418/pexels-photo-3184418.jpeg" alt="Vectral Spaces">
                                </div>
                                <div class="card-content">
                                    <h4 class="card-title">Vectral Spaces 101</h4>
                                    <p class="card-meta">by Olivia Chen</p>
                                    <div class="card-stats">
                                        <span><i class="fas fa-heart text-danger me-1"></i>189</span>
                                        <span><i class="fas fa-comment text-info me-1"></i>15</span>
                                        <span class="ms-auto text-muted">5 days ago</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
                <!-- Community Section (Static) -->
                <div class="tab-content" id="tab-community">
                    <!-- Threads -->
                    <div class="row g-4 mb-5">
                        <div class="col-lg-9">
                            <section class="content-section">
                                <div class="threads-section-header">
                                    <h2 class="section-title">Threads</h2>
                                    <div>
                                        <button class="threads-icons">
                                            <i class="fa-solid fa-angle-down"></i>
                                            Topic
                                        </button>
                                        <button class="threads-icons">
                                            <i class="fa-solid fa-filter"></i>
                                            Sort
                                        </button>
                                        <button class="threads-icons">
                                            <i class="fa-solid fa-book-bookmark"></i>
                                            Bookmarks
                                        </button>
                                        <button class="threads-icons">
                                            <i class="fa-solid fa-magnifying-glass"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="threads-list">
                                    <div class="threads-item">
                                        <div class="threads-user">
                                            <div class="threads-user-avatar">RM</div>
                                            <h4 class="threads-user-name">Rahul M</h4>
                                        </div>
                                        <div class="threads-header">
                                            <h4 class="threads-name">Best way to schedule multiple emails at once</h4>
                                        </div>
                                        <p class="threads-description">I'm trying to figure out if there's a faster workflow for adding several scheduled emails. Is there a bulk option or do I need to set times one by one?</p>
                                        <div class="threads-footer">
                                            <span class="tag"># schedule</span>
                                            <span>2h ago</span>
                                            <span class="ms-auto">
                                                <button class="threads-icons" type="button">
                                                    <i class="fa-regular fa-bookmark" id="bookmarkIcon"></i>
                                                </button>
                                                <button class="threads-icons icon-like" type="button">
                                                    <i class="fa-solid fa-heart"></i>
                                                    21
                                                </button>
                                                <button class="threads-icons icon-reply" type="button">
                                                    <i class="fa-solid fa-message"></i>
                                                    Reply
                                                </button>
                                            </span>
                                        </div>
                                    </div>

                                    <div class="threads-list">
                                    <div class="threads-item">
                                        <div class="threads-user">
                                            <div class="threads-user-avatar">KP</div>
                                            <h4 class="threads-user-name">Karan P</h4>
                                        </div>
                                        <div class="threads-header">
                                            <h4 class="threads-name">How do I compose with saved groups</h4>
                                        </div>
                                        <p class="threads-description">When composing a new email, I want to auto-select a group instead of picking users manually. Anyone know where that option is located?</p>
                                        <div class="threads-footer">
                                            <span class="tag"># compose</span>
                                            <span class="tag"># groups</span>
                                            <span>5h ago</span>
                                            <span class="ms-auto">
                                                <button class="threads-icons" type="button">
                                                    <i class="fa-regular fa-bookmark" id="bookmarkIcon"></i>
                                                </button>
                                                <button class="threads-icons icon-like" type="button">
                                                    <i class="fa-solid fa-heart"></i>
                                                    35
                                                </button>
                                                <button class="threads-icons icon-reply" type="button">
                                                    <i class="fa-solid fa-message"></i>
                                                    Reply
                                                </button>
                                            </span>
                                        </div>
                                    </div>

                                    <div class="threads-list">
                                    <div class="threads-item">
                                        <div class="threads-user">
                                            <div class="threads-user-avatar">MS</div>
                                            <h4 class="threads-user-name">Mira S</h4>
                                        </div>
                                        <div class="threads-header">
                                            <h4 class="threads-name">Basic guide for first-time users</h4>
                                        </div>
                                        <p class="threads-description">Iâ€™m new to the platform and looking for a simple explanation of the workflow: compose â†’ schedule â†’ manage. Any official guide or user tips?</p>
                                        <div class="threads-footer">
                                            <span class="tag"># guide</span>
                                            <span>8h ago</span>
                                            <span class="ms-auto">
                                                <button class="threads-icons" type="button">
                                                    <i class="fa-regular fa-bookmark" id="bookmarkIcon"></i>
                                                </button>
                                                <button class="threads-icons icon-like" type="button">
                                                    <i class="fa-solid fa-heart"></i>
                                                    32
                                                </button>
                                                <button class="threads-icons icon-reply" type="button">
                                                    <i class="fa-solid fa-message"></i>
                                                    Reply
                                                </button>
                                            </span>
                                        </div>
                                    </div>

                                    <div class="threads-list">
                                    <div class="threads-item">
                                        <div class="threads-user">
                                            <div class="threads-user-avatar">DR</div>
                                            <h4 class="threads-user-name">Devansh R</h4>
                                        </div>
                                        <div class="threads-header">
                                            <h4 class="threads-name">Issue adding contacts to groups</h4>
                                        </div>
                                        <p class="threads-description">I created groups but adding contacts feels inconsistent. Sometimes the changes donâ€™t save. Am I missing a required step?</p>
                                        <div class="threads-footer">
                                            <span class="tag"># groups</span>
                                            <span>11h ago</span>
                                            <span class="ms-auto">
                                                <button class="threads-icons" type="button">
                                                    <i class="fa-regular fa-bookmark" id="bookmarkIcon"></i>
                                                </button>
                                                <button class="threads-icons icon-like" type="button">
                                                    <i class="fa-solid fa-heart"></i>
                                                    16
                                                </button>
                                                <button class="threads-icons icon-reply" type="button">
                                                    <i class="fa-solid fa-message"></i>
                                                    Reply
                                                </button>
                                            </span>
                                        </div>
                                    </div>

                                    <div class="threads-list">
                                    <div class="threads-item">
                                        <div class="threads-user">
                                            <div class="threads-user-avatar">ST</div>
                                            <h4 class="threads-user-name">Sana T</h4>
                                        </div>
                                        <div class="threads-header">
                                            <h4 class="threads-name">Can scheduled emails be edited after saving</h4>
                                        </div>
                                        <p class="threads-description">If I schedule an email and later need to change the content or time, is there an edit option or do I delete and recreate it?</p>
                                        <div class="threads-footer">
                                            <span class="tag"># schedule</span>
                                            <span class="tag"># guide</span>
                                            <span>14h ago</span>
                                            <span class="ms-auto">
                                                <button class="threads-icons" type="button">
                                                    <i class="fa-regular fa-bookmark" id="bookmarkIcon"></i>
                                                </button>
                                                <button class="threads-icons icon-like" type="button">
                                                    <i class="fa-solid fa-heart"></i>
                                                    14
                                                </button>
                                                <button class="threads-icons icon-reply" type="button">
                                                    <i class="fa-solid fa-message"></i>
                                                    Reply
                                                </button>
                                            </span>
                                        </div>
                                    </div>
                            </section>
                        </div>
                        <div class="col-lg-3">
                            <button class="thread-new btn-primary">New Post</button>
                            <br>
                            <!-- REUSING THREADS CLASSES HERE -->
                            <section class="content-section">
                                <div class="threads-section-header">
                                    <h2 class="section-title">Active topics</h2>
                                </div>
                                <div class="threads-item">
                                    <div class="threads-tag-stats">
                                        <span class="tag"># schedule</span>
                                        <span class="ms-auto">16</span>
                                    </div>
                                </div>
                                <div class="threads-item">
                                    <div class="threads-tag-stats">
                                        <span class="tag"># compose</span>
                                        <span class="ms-auto">14</span>
                                    </div>
                                </div>
                                <div class="threads-item">
                                    <div class="threads-tag-stats">
                                        <span class="tag"># guide</span>
                                        <span class="ms-auto">10</span>
                                    </div>
                                </div>
                                <div class="threads-item">
                                    <div class="threads-tag-stats">
                                        <span class="tag"># groups</span>
                                        <span class="ms-auto">9</span>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    <!-- Add New Group Popup -->
    <div id="groupPopup" class="popup">
        <div class="popup-content">
            <h2 class="section-title">Groups</h2>

            <form method="POST" action="{% url 'core:create_group' %}">
                {% csrf_token %}

                <label>Name</label>
                <input type="text" class="input-box" name="name" required>

                <label>Description</label>
                <input type="text" class="input-box" name="description">

                <label>Recipients</label>
                <textarea class="input-box large-box" name="recipients" placeholder="one@gmail.com, two@gmail.com"></textarea>

                <div class="actions">
                    <button id="closePopup" class="btn btn-secondary" type="button">Close</button>
                    <button class="btn btn-primary" type="submit">Create</button>
                </div>
            </form>
        </div>
    </div>
    <!-- Django Messages -->
    {% if messages %}
    <script>
        {% for message in messages %}
            alert("{{ message|escapejs }}");
        {% endfor %}
    </script>
    {% endif %}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{% static 'dashboard.js' %}"></script>
</body>
</html>